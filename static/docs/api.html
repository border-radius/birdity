<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>API бирдости</title>
  <link rel="stylesheet" href="/birdity.css">
</head>
<body>
  <div class="page">
  	<h2>API</h2>

  	<p>Все методы API требуют авторизации, за исключением <code>POST /api/user</code> и <code>GET /api/user</code>.</p>
  	<p>Аутенфикационный токен передается в поле <code>token</code>.</p>
  	<p>Следите за HTTP-кодом ответа. В случае возникновения ошибки, также возвращается JSON с кодом ошибки и ее описанием:</p>

  	<pre><code>{
  "error": {
    "code": 238328,
    "text": "Ты пидор."
  }
}</code></pre>
	
	<h3>/api/user</h3>

	<ul>
		<li>
			<p><code>GET</code> с полями <code>email</code> и <code>password</code></p>
			<p>Авторизация пользователя. Возвращает аутенфикационный токен в случае успеха.</p>
			<pre><code>{
  "token": "1q2w3e4r5t6y7u8i9o0p"
}</code></pre>
		</li>

		<li>
			<p><code>POST</code> с полем <code>email</code></p>
			<p>Регистрация нового пользователя.</p>
		</li>
		<li>
			<p><code>PUT</code> с полем <code>userpic</code>, либо <code>name</code>, либо <code>password</code>. Можно все вместе.</p>
			<p>Обновление профиля пользователя. До тех пор, пока не будут установлены все три поля, остальное API недоступно.</p>
			<pre><code>{
  "error": {
    "code": 1,
    "text": "Профиль не заполнен."
  }
}</code></pre>
		</li>
		<li>
			<p><code>DELETE</code></p>
			<p>Разлогиниться.</p>
		</li>
	</ul>

	<h3>/api/chats</h3>

	<ul>
		<li>
			<p><code>GET</code> с опциональным полем <code>skip</code></p>
			<p>Возвращает список чатов пользователя.</p>
			<pre><code>{
  "chats": [
    {
      "id": 1,
      "type": "link",
      "text": "Бирдость",
      "unread": 12
    },
    {
      "id": 2,
      "type": "user",
      "userpic": "/userpics/1.jpg",
      "text": "238328",
      "unread": 0
    },
    {
      "id": 3,
      "type": "chat",
      "text": "Привет, бирдость!",
      "unread": 1
    }
  ]
}</code></pre>
		</li>
	</ul>

	<h3>/api/chats/:id</h3>

	<ul>
		<li>
			<p><code>GET</code> с опциональным полем <code>skip</code></p>
			<p>Возвращает список сообщений чата.</p>
			<pre><code>{
  "messages": [
    {
      "id": 1,
      "chatid": 3,
      "userid": 1,
      "userpic": "/userpics/1.jpg",
      "text": "Привет, бирдость!"
    }
  ]
}</code></pre>
		</li>
	</ul>
  </div>
</body>
</html>